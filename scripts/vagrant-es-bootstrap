#!/bin/bash

source "$(cd `dirname "${BASH_SOURCE[0]}"` && pwd)/vagrant-bootstrap-functions"

echo 'Atualizando repositório Yum'
yum makecache fast -y
yum remove puppet -y
yum update -y
yum install epel-release lsof git rpm-build augeas -y

# Remove obrigação de TTY para sudoers em deployments automáticos
augtool set '/files/etc/sudoers/Defaults[*]/requiretty/negate' ''

instalar_jdk
instalar_elasticsearch $1

echo "Modificando hostname para '${1}'..."
hostname $1

echo 'Abrindo portas 9200 e 9300 no firewall...'
firewall-cmd --permanent --add-port 9200/tcp
firewall-cmd --permanent --add-port 9300/tcp

echo 'Salvando alterações do firewall...'
firewall-cmd --reload
