<?xml version="1.0"?>
<servico xmlns="http://servicos.gov.br/carta/v1/servico"
         xmlns:th="http://www.thymeleaf.org"
         th:with="base = ${#httpServletRequest.requestURL.toString().replaceAll('^(http://(.*?))/(.*)$', '$1')}">

    <link rel="self" th:href="${base + '/servico/' + servico.id}"/>

    <id th:text="${servico.id}"/>

    <nome th:text="${servico.titulo}"/>

    <descricao th:text="${servico.descricao.trim()}"/>

    <orgaoResponsavel>
        <nome th:text="${servico.responsavel.nome}"/>
        <link rel="orgao-responsavel" th:href="${base + '/orgao/' + servico.responsavel.id}"/>
    </orgaoResponsavel>

    <orgaoPrestador>
        <nome th:text="${servico.prestador.nome}"/>
        <link rel="orgao-prestador" th:href="${base + '/orgao/' + servico.prestador.id}"/>
    </orgaoPrestador>

    <resultadosEsperados/>
    <quemPodeUtilizar/>
    <preRequisitos/>
    <tempoTotalEstimado/>
    <custoTotalEstimado th:text="${servico.taxa}"/>
    <proximosPassos/>
    <palavrasChave/>
    <ativo/>
    <legislacaoRelacionada/>

    <segmentosDaSociedade th:each="publicoAlvo : ${servico.publicosAlvo}">
        <segmentoDaSociedade>
            <nome th:text="${publicoAlvo.titulo}"/>
            <link rel="segmento-da-sociedade" th:href="${base + '/publico-alvo/' + publicoAlvo.id}"/>
        </segmentoDaSociedade>
    </segmentosDaSociedade>

    <eventosDaLinhaDaVida th:each="linhaDaVida : ${servico.linhasDaVida}">
        <eventoDaLinhaDaVida>
            <nome th:text="${linhaDaVida.titulo}"/>
            <link rel="linha-da-vida" th:href="${base + '/linha-da-vida/' + linhaDaVida.id}"/>
        </eventoDaLinhaDaVida>
    </eventosDaLinhaDaVida>

    <areasDeInteresse th:each="areaDeInteresse : ${servico.areasDeInteresse}">
        <areaDeInteresse>
            <nome th:text="${areaDeInteresse.titulo}"/>
            <link rel="area-de-interesse" th:href="${base + '/area-de-interesse/' + areaDeInteresse.id}"/>
        </areaDeInteresse>
    </areasDeInteresse>

    <canaisDePrestacao th:each="canalDePrestacao : ${servico.canaisDePrestacao}">
        <canalDePrestacao th:attr="tipo=${canalDePrestacao.tipo}">
            <descricao th:text="${canalDePrestacao.descricao}"/>
            <link th:rel="${'canal-de-prestacao#' + @slugify.slugify(canalDePrestacao.tipo)}"
                  th:href="${canalDePrestacao.url}" th:unless="${#strings.isEmpty(canalDePrestacao.url)}"/>
        </canalDePrestacao>
    </canaisDePrestacao>

    <informacoesUteis th:each="informacaoUtil : ${servico.informacoesUteis}">
        <informacaoUtil th:attr="tipo=${informacaoUtil.tipo}">
            <descricao th:text="${informacaoUtil.descricao}"/>
            <link th:rel="${'informacao-util#' + @slugify.slugify(informacaoUtil.tipo)}"
                  th:href="${informacaoUtil.url}" th:unless="${#strings.isEmpty(informacaoUtil.url)}"/>
        </informacaoUtil>
    </informacoesUteis>
</servico>